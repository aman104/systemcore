CREATE TABLE config (id BIGINT AUTO_INCREMENT, record VARCHAR(255) NOT NULL UNIQUE, value text NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE email (id BIGINT AUTO_INCREMENT, email VARCHAR(255) NOT NULL UNIQUE, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE mailing (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, title VARCHAR(255) NOT NULL, html text, public text, status BIGINT DEFAULT 1 NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE mailing_list (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, name VARCHAR(255), hash VARCHAR(8) UNIQUE, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE mailing_list2_email (mailing_list_id BIGINT, email_id BIGINT, name VARCHAR(255) NOT NULL, phone VARCHAR(255) NOT NULL, status BIGINT DEFAULT 1 NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(mailing_list_id, email_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE sm_config (id BIGINT AUTO_INCREMENT, record VARCHAR(255) NOT NULL UNIQUE, value text NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE user (id BIGINT AUTO_INCREMENT, username VARCHAR(255) NOT NULL UNIQUE, api_token VARCHAR(255) NOT NULL UNIQUE, api_secret VARCHAR(255) NOT NULL UNIQUE, first_name VARCHAR(255) NOT NULL, last_name VARCHAR(255) NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(255), street VARCHAR(255), post_code VARCHAR(255), city VARCHAR(255), country VARCHAR(255), is_company TINYINT(1) DEFAULT '0', nip VARCHAR(255), status BIGINT DEFAULT 1 NOT NULL, invoice_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
CREATE TABLE user_data (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, point BIGINT DEFAULT 500 NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = INNODB;
ALTER TABLE mailing ADD CONSTRAINT mailing_user_id_user_id FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE mailing_list ADD CONSTRAINT mailing_list_user_id_user_id FOREIGN KEY (user_id) REFERENCES user(id) ON DELETE CASCADE;
ALTER TABLE mailing_list2_email ADD CONSTRAINT mailing_list2_email_mailing_list_id_mailing_list_id FOREIGN KEY (mailing_list_id) REFERENCES mailing_list(id);
ALTER TABLE mailing_list2_email ADD CONSTRAINT mailing_list2_email_email_id_email_id FOREIGN KEY (email_id) REFERENCES email(id);
ALTER TABLE user_data ADD CONSTRAINT user_data_user_id_user_id FOREIGN KEY (user_id) REFERENCES user(id) ON DELETE CASCADE;
